\section{Subcategory, generating system}

\begin{definition}
Let \[ U = (Obj(U), Mor(U), Q_U, Z_U, \circ_U) \] and \[C = (Obj(C), Mor(C),
Q_C, Z_C, \circ_C)\] be categories.

$U$ is called a {\bf subcategory} of $C \Leftrightarrow$
\begin{enumerate}
  \item $Obj(U) \subset Obj(C)$ and $Mor(U) \subset Mor(C)$
  \item $Q_U = Q_C|_{Mor(U)}$ and $Z_U = Z_C|_{Mor(U)}$
  \item $\circ_U = \circ_C|_{Mor(U) \times Mor(U)}$
  \item For $w \in Obj(U) \Rightarrow 1_w \in Mor(U)$
\end{enumerate}
\end{definition}

$U$ is called {\bf full subcategory} of $C \Leftrightarrow$
\[ \forall w_1, w_2 \in Obj(U), f: w_1 \to w_2 \in Mor(C) \Rightarrow f \in
Mor(U) \]

This means, all morphisms in $C$ between objects in $U$ are also morphisms in
$U$. $f: w_1 \to w_2$ stands for $Q(f) = w_1 \wedge Z(f) = w_2$.

We want to explain this fact at some examples:

{\bf Example 1}:

Let $A = \{ x,y,z,a,b,c \}$ and $f, g, h: A^* \to A^*$ be mappings defined as
follows:
\[ f(u_1 \cdot x \cdot u_2 \cdot x \cdots x \cdot u_k \cdot x) = 
u_1 \cdot ax \cdot u_2 \cdot ax \cdots ax \cdot u_k \cdot ax) \]

where $u_i \in (A - \{x\})^*$,

\[ g(u_1 \cdot y \cdot u_2 \cdot y \cdots y \cdot u_k \cdot y) = 
u_1 \cdot by \cdot u_2 \cdot by \cdots by \cdot u_k \cdot by) \]

where $u_i \in (A - y\})^*$,

\[ h(u_1 \cdot z \cdot u_2 \cdot z \cdots z \cdot u_k \cdot z) = 
u_1 \cdot cz \cdot u_2 \cdot cz \cdots cz \cdot u_k \cdot cz) \]

where $u_i \in (A - y\})^*$.

Let $M$ be the monoid of mappings generated by $f, g, h : A^* \to A^*$.

Then $C = ({A^*}, M, Q, Z, \circ)$ is a category, if $\circ$ denotes the monoid
operation in $M$.

Let $G$ be the graph defined by the following figure:

\begin{tikzpicture}
	\node[state]	(1)	{$1$};
	\path[->](1) edge [loop below] node {e} ();
\end{tikzpicture}

We define a functor $\phi = (\mathcal{W}(G), C, \phi_1, \phi_2)$ by $\phi_1(1)
:= A^*$ and $\phi_2(e) := f \circ g \circ h$.

$\phi_2(\mathcal{W}(G))$ is a subcategory of $C$ and it holds:
\[ \phi_2(\mathcal{W}(G))(xyz) = \{ (a^n x b^n y c^n z)\ |\ n \in \mathbb{N} \}
\]

{\bf Example 2}:

We expand on example 1. In addition to $f,g,h$ we have three monoid
homomorphisms $f_1,g_1,h_1$ defined by:
\begin{eqnarray*}
f_1(x) = \epsilon, f_1(u) = u \quad\forall u \in A - \{x\} \\
g_1(y) = \epsilon, g_1(u) = u \quad\forall u \in A - y\} \\
h_1(z) = \epsilon, h_1(u) = u \quad\forall u \in A - z\} \\
\end{eqnarray*}

We extend the graph $G$ as follows to a graph $G_1$:

\begin{tikzpicture}
	\node[state] 	(1)										{$1$};
	\node[state] 	(2) [right=60pt]				{$2$};
	\path[->]			(1) edge [loop below] node {$e$} 			()
							 			edge 							node {$e_1$} 	(2);
\end{tikzpicture}

Consider $\mathcal{W}(G_1)(1,2)$. Then $\mathcal{W}(G_1)(1,2) \cup \{1_1,
1_2\}$ is a subcategory of $\mathcal{W}(G_1)$. In addition, $\mathcal{W}(G)$ is
a subcategory of $\mathcal{W}(G_1)$. 

We extend the functor $\phi$ from example 1
onto $\mathcal{W}(G_1)$ by defining:
\[ \phi_2(e_1) := f_1 \circ g_1 \circ h_1 \]

We get:
\[ \phi_2(\mathcal{W}(G_1)(1,2))(xyz) = \{ (a^n b^n c^n\ |\ n \in \mathbb{N} \}.
\]

{\bf Example 3}:

Let $G$ be defined as follows:

\begin{tikzpicture}
	\node[state]	(1)	{$1$};
	\path[->](1) edge [loop below] node {e} ();
\end{tikzpicture}

The full subcategory of $\mathcal{W}(G)$ generated by $\{ 1', 2', 3' \}$ is the
path category $\mathcal{W}(G')$ with the following graph $G'$:

FIGURE

As an exercise, one can show: The mapping $\phi_1$ defined by 
\begin{eqnarray*}
\phi_1(1) & = & 1' \\
\phi_1(4) & = & 1' \\
\phi_1(2) & = & 2' \\
\phi_1(5) & = & 2' \\
\phi_1(3) & = & 3' \\
\phi_1(6) & = & 3' \\
\end{eqnarray*}
can be extended to a functor $\phi = (\mathcal{W}(G), \mathcal{W'}(G'),
\phi_1, \phi_2)$ where $\phi_2$ has to be chosen in a suitable way.

Remark: The preimage of a closed path does not have to be closed.

We prove now the following
\begin{lemma}
Let \[ C_i = (O_i, M_i, Q, Z, \circ),\ i = 1, 2, 3 \] be categories and $C_1$
and $C_2$ be subcategories of $C_3$. Then $C_1 \cap C_2$ is a category.
\end{lemma}

Proof: It holds
\begin{enumerate}
  \item $w \in O_1 \cap O_2 \Rightarrow 1_w \in M_1 \cap M_2$
  \item $f, g \in M_1 \cap M_2 \Rightarrow f \circ g \in M_1 \cap M_2$, if
  $Z(f) = Q(g)$
\end{enumerate}

It follows that $C_1 \cap C_2$ is a category.

\begin{lemma}
Let $ C_i = (O_i, M_i, Q, Z, \circ),\ i \in I,$\ where $I$ is an arbitrary
index set, be categories. If $C_I, i \in I,$\ are subcategories of a category
$C$, then \[ \tilde{C} := \bigcap_{i \in I} C_i \] is a category.
\end{lemma}

The proof is similar as the one of the previous lemma.

\begin{definition}[generated subcategory]

Let $C = (O, M, Q, Z, \circ)$\ be a category and $O_1 \subset O, M_1 \subset M$
and \[ \mathcal{U}_C(O_1, M_1) := \{ C'\ |\ C'\ \mbox{is subcategory of}\ C, O_1
\subset O', M_1 \subset M' \}. \]

Then \[ {<}O_1, M_1{>} := \bigcap_{C' \in \mathcal{U}_C(O_1, M_1)} C' \] is
called the subcategory of $C$ generated by $(O_1, M_1)$ and $(O_1, M_1)$ is called the
generating system of ${<}(O_1, M_1){>}$.
\end{definition}

Obviously for each category $C = (O, M, Q, Z, \circ)$ it holds: $C = {<}O,
M{}>$.

We say $M_1$ ''generates'' ${<}O_1, M_1{>}$, if \[ O_1 = \{ Q(m)\ |\ m \in M_1
\} \cup \{ Z(M)\ |\ m \in M_1 \}. \]

We have already seen an example for a nontrivial generating system.

Let $G = (V,E)$ be a graph, then $E$ is a generating system of $\mathcal{W}(G)$
which means $\mathcal{W}(G) = {<}E(G){>}$. The path category of a graph has a
special property namely that $E(G)$ is a {\bf free} generating system of
$\mathcal{W}(G)$.

\begin{definition}[free generating system]
Let $C = (O, M, Q, Z, \circ)$ be a category and $E \subset M$. $E$ is called a
{\bf free generating system} of $C$, if the following holds:

If $C' = (O', M', Q, Z, \circ)$ is an arbitrary category and $\phi_1 : O \to O'$
and $\phi_s : E \to M'$ are mappings which fulfill the following diagram:

\begin{center}
\begin{tikzcd}[row sep=large,column sep=huge]
 O \arrow[leftarrow]{r}{Q} \arrow{d}{\phi_1} & E \arrow{r}{Z}
 \arrow{d}{\phi'_2} & O \arrow{d}{\phi_1} \\
 O' \arrow[leftarrow]{r}{Q} & M' \arrow{r}{Z} & O'
\end{tikzcd}
\end{center}

Then there exists a unique continuation of $\phi'_2$ to $\phi_2 : M \to M'$ such
that $\phi = (C, C', \phi_1, \phi_2)$ is a functor.
\end{definition}

\begin{definition}[free category]
A category $C$ is called {\bf free} if there exists a free generating system $E$
of $C$.
\end{definition}

We formulate now our observation above as a theorem:

\begin{theorem}
Let $G = (V, E)$ be a graph. Then $E$ is a free generating system of
$\mathcal{W}(G)$.
\end{theorem} 

Proof: Let $G = (V, E)$ be a graph and $C$ an arbitrary category. Let $\phi_1 :
E \to O,\ \phi'_2 : E \to M$ be mappings and the following diagram commute:

\begin{center}
\begin{tikzcd}[column sep=huge,row sep=large]
 V \arrow[leftarrow]{r}{Q} \arrow{d}{\phi_1} & E \arrow{r}{Z}
 \arrow{d}{\phi'_2} & V \arrow{d}{\phi_1} \\
 O \arrow[leftarrow]{r}{Q} & M \arrow{r}{Z} & O
\end{tikzcd}
\end{center}

We define \[ \phi_2(P,P) = 1_{\phi_1(P)}, P \in V \] and \[ \phi_2(e) =
\phi'_2(e), e \in E \]

Let $\phi_2(w)$ be defined for all $w \in \mathcal{W}(G)$ with $|w| \leq n, n
\geq 1$ and $\phi_2$ be compatible with $Q$ and $Z$ for all these paths $w$.

Further let $\phi_2$ be uniquely determined for these paths $w$ and it holds: \[
\phi_2(w \cdot v) = \phi_2(w) \cdot \phi_2(u) \]
for all $w, v$ with $|w \cdot v| \leq n$.

Now let $v = (P, s_1, \ldots, s_{n+1}, P') \in \mathcal{W}(G)$. We split $v$
into \[ v = (P, \underbrace{s_1, \ldots, s_n}_{v_1}, P'') \cdot (P'',
\underbrace{s_{n+1}}_{v_2}, P') \].

By induction hypothesis, $\phi_2(v_1)$ and $\phi_2(v_2)$ are defined.

For $\phi_2$ to become a functor, necessarily $\phi_2(v) = \phi_2(v1) \cdot
\phi_2(v_2)$ must hold.

By assumption, $\phi_2$ is compatible with source and target mappings $Q$ and
$Z$ for $v_1$ and $v_2$. Therefore $Z(\phi_2(v_1)) = Q(\phi_2(v_2))$ and
$\phi_2(v)$ is defined.

Let $v = u_1 \cdot u_2$ be any partition of $v$, so \[ v = (P, \underbrace{s_1,
\ldots, s_j}_{u_1}, \bar{P}) \cdot (\bar{P}, \underbrace{s_{j+1},
\ldots, s_{n+1}}_{u_2}, P'). \]

By induction hypothesis it holds:
\begin{enumerate}
  \item $Z(\phi_2(u_1)) = Q(\phi_2(u_2))$, so $\phi_2(u1) \cdot \phi_2(u_2)$ is
  defined.
  \item With $u'_2 = (\bar{P}, s_{j+1}, \ldots, s_n, P'')$ we have
  \begin{eqnarray*}
  \phi_2(u_1) \cdot \phi_2(u_2) & = & \phi_2(u_1) \cdot (\phi_2(u'_2) \cdot
  \phi_2(v_2)) \\
  & = & (\phi_2(u_1) \cdot \phi_2(u'_2)) \cdot \phi_2(v_2) \\
  & = & \phi_2(v_1) \cdot \phi_2(v_2) \\
  & = & \phi_2(v)
  \end{eqnarray*}
\end{enumerate}

It remains to show \[ \phi_1(Q(v)) = Q(\phi_2(v)),\quad \phi_1(Z(v)) =
Z(\phi_2(v)) \]

This follows directly from $Q(v) = Q(v_1)$ and $Z(v) = Z(v_2)$ by induction
hypothesis.

\begin{theorem}
To each category $C$ there exists a free category $F$ and a surjective functor
$\phi = (F, C, \phi_1, \phi_2)$.
\end{theorem}

Proof: For the category $C$, create the oriented graph $G_C = (V, E)$ with $V =
Obj(C)$ and $E = \{ f\ |\ Q(f) = O_1, Z(f) = O_2, f : O_1 \to O_2 \in M \}$.

That means: The objects of the category become the points of the graph and each
morphism becomes an edge between the corresponding source and target objects.
Because $\mathcal{W}(G_C)$ is a free category by theorem 1 we can choose $F$ to
be exactly this category.

Let $\phi_1 : V \to O$ with $\phi_1(w) = w$ and $\phi'_2 : E \to M$ with
$\phi'_2(f) = f$ be mappings and $\phi_2 : \mathcal{W}(G_C) \to M$ be the
continuation of $\phi'_2$ such that $\phi = (\mathcal{W}(G_C), C, \phi_2,
\phi_2)$ becomes a functor.

By construction, $\phi$ is surjective.

The following theorem tells about the uniqueness of free generating systems.

\begin{theorem}
If $E$ and $E'$ are free generating systems of a category $F$, then $E = E'$.
\end{theorem}

The proof is similar to the one of the corresponding theorem for free monoids.
